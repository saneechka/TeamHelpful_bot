# TeamHelpful Bot

Telegram-бот с системой регистрации и авторизации пользователей.

## Архитектура проекта

Проект построен с использованием принципов чистой архитектуры и разделения ответственности:

- **Domain** - модели и бизнес-логика
- **Repository** - работа с данными
- **Service** - бизнес-логика
- **Delivery** - обработка запросов от Telegram

## Структура проекта

```
├── cmd
│   └── bot
│       └── main.go           # Точка входа в приложение
├── client
│   └── telegram              # Клиент для работы с Telegram API
│       ├── client.go
│       └── types.go
├── internal
│   ├── config                # Конфигурация приложения
│   │   └── config.go
│   ├── domain                # Модели и интерфейсы
│   │   ├── messages.go
│   │   ├── repository.go
│   │   ├── service.go
│   │   └── user.go
│   ├── repository            # Реализация репозиториев
│   │   └── sqlite
│   │       ├── db.go
│   │       └── user_repository.go
│   ├── service               # Реализация сервисов
│   │   ├── auth_service.go
│   │   ├── session_service.go
│   │   └── user_service.go
│   └── delivery              # Обработка запросов
│       └── telegram
│           ├── handler.go
│           └── keyboard.go
├── Dockerfile               # Сборка Docker образа
├── docker-compose.yml      # Конфигурация Docker Compose
├── go.mod                  # Зависимости
└── README.md               # Документация
```

## Функциональность

- Регистрация новых пользователей
- Авторизация существующих пользователей
- JWT-авторизация
- Роли пользователей (admin/user)

## Запуск

### Требования

- Go 1.21 или выше
- SQLite
- Docker и Docker Compose (для контейнеризации)

### Переменные окружения

Создайте файл `.env` со следующими переменными:

```env
# Обязательные переменные
BOT_TOKEN=your_telegram_bot_token    # Токен вашего Telegram бота
DB_PATH=users.db                     # Путь к файлу базы данных

# Опциональные переменные
JWT_SECRET=your_secret_key           # Секретный ключ для JWT (если не указан, генерируется автоматически)
JWT_EXPIRATION=24                    # Время жизни JWT токена в часах (по умолчанию: 24)
DEBUG=false                          # Режим отладки (по умолчанию: false)
POLL_TIMEOUT=60                      # Таймаут опроса в секундах (по умолчанию: 60)
```

### Локальный запуск

```bash
# Сборка
make build

# Запуск
make run

# Запуск без сборки
make run-dev
```

### Запуск с Docker Compose

1. Создайте файл `.env` с необходимыми переменными окружения (как описано выше)
2. Запустите контейнер:
```bash
docker-compose up -d
```

## Команды бота

- `/start` - Начать работу с ботом
- `/help` - Получить справку
- `/login` - Войти в систему
- `/register` - Зарегистрироваться
- `/logout` - Выйти из системы

## Безопасность

### Хранение паролей
- Пароли хешируются с использованием bcrypt с оптимальной стоимостью
- Исходные пароли никогда не сохраняются в базе данных
- При каждом хешировании автоматически генерируется уникальная соль

### JWT авторизация
- Используются токены с ограниченным временем жизни
- Секретный ключ генерируется автоматически при запуске (если не указан)
- Поддерживается ротация ключей через переменные окружения

### База данных
- Защита от SQL-инъекций через подготовленные выражения
- Безопасное хранение чувствительных данных
- Автоматическое обновление временных меток

### Общие меры безопасности
- Валидация всех входных данных
- Ограничение попыток входа
- Безопасное хранение токенов и секретов
- Логирование важных событий безопасности

## Поддержка

- GitHub Issues: [создать issue](https://github.com/saneechka/teamHelpful_bot/issues)
- Telegram: [@bell1matita](https://t.me/bell1matita)
- Email: alexandro.dev.work@gmail.com

